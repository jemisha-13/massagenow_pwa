{"version":3,"sources":["ng://ngx-stars/lib/ngx-stars.component.ts","ng://ngx-stars/lib/ngx-stars.module.ts"],"names":["NgxStarsComponent","this","maxStars","initialStars","animationSpeed","wholeStars","ratingOutput","EventEmitter","Math","random","toString","substring","Number","isInteger","_this","size","prototype","ngOnInit","setupStarImages","editableStars","Array","from","map","elem","index","EditableStar","setRating","animation","animationInterval","setInterval","starAnimation","bind","ngOnDestroy","customCssClasses","forEach","style","parentNode","removeChild","customStarIcons","Object","keys","key","starType","classname","getStarClass","createCssClass","clazz","document","createElement","type","innerHTML","getElementsByTagName","appendChild","push","starPadding","margin-right","customPadding","safeSize","starColorAndSize","assign","starColor","starSize","background-color","color","height","width","animationRunning","rating","cancelStarAnimation","clearInterval","round","onStarsUnhover","onStarHover","event","clickedStar","clickedInFirstHalf","star","position","onStarClick","emit","onZeroStarClick","onZeroStarHover","starNumber","starIcon","pageX","getBoundingClientRect","left","offsetWidth","noop","customClassIdentifier","Component","args","selector","template","styles","Input","Output","NgxStarsModule","NgModule","imports","CommonModule","declarations","exports"],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Input, OnDestroy, OnInit, Output } from '@angular/core';\n\n@Component({\n  selector: 'ngx-stars',\n  template: `<div class=\"stars-line\" (mouseleave)=\"readonly ? noop() : onStarsUnhover()\">\n  <span class=\"star zero-star\" [ngStyle]=\"starSize()\" aria-hidden=\"true\" (click)=\"onZeroStarClick()\" (mousemove)=\"readonly ? noop() : onZeroStarHover()\"></span>\n  <div *ngFor=\"let star of editableStars;\" [ngStyle]=\"starPadding()\" (click)=\"readonly ? noop() : onStarClick($event, star)\" (mousemove)=\"readonly ? noop() : onStarHover($event, star)\">\n    <span class=\"star\" [ngClass]=\"star.classname\" [ngStyle]=\"starColorAndSize()\" aria-hidden=\"true\"></span>\n  </div>\n</div>\n`,\n  styles: [`.stars-line{display:flex;align-items:center;position:relative}.stars-line>div{z-index:999}.zero-star{color:transparent;position:absolute;left:-16px}.star{display:inline-block;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.star-empty{-webkit-mask-image:url(\"data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='far' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z'%3E%3C/path%3E%3C/svg%3E%0A\");mask-image:url(\"data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='far' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z'%3E%3C/path%3E%3C/svg%3E%0A\")}.star-half{-webkit-mask-image:url(\"data:image/svg+xml,%3C!-- had to hack this one's viewbox otherwise it didn't line up with the other two --%3E%3C!-- changed viewbox from '0 0 536 512' to '-20 0 576 512' --%3E%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star-half-alt' class='svg-inline--fa fa-star-half-alt fa-w-17' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='-20 0 576 512'%3E%3Cpath fill='currentColor' d='M508.55 171.51L362.18 150.2 296.77 17.81C290.89 5.98 279.42 0 267.95 0c-11.4 0-22.79 5.9-28.69 17.81l-65.43 132.38-146.38 21.29c-26.25 3.8-36.77 36.09-17.74 54.59l105.89 103-25.06 145.48C86.98 495.33 103.57 512 122.15 512c4.93 0 10-1.17 14.87-3.75l130.95-68.68 130.94 68.7c4.86 2.55 9.92 3.71 14.83 3.71 18.6 0 35.22-16.61 31.66-37.4l-25.03-145.49 105.91-102.98c19.04-18.5 8.52-50.8-17.73-54.6zm-121.74 123.2l-18.12 17.62 4.28 24.88 19.52 113.45-102.13-53.59-22.38-11.74.03-317.19 51.03 103.29 11.18 22.63 25.01 3.64 114.23 16.63-82.65 80.38z'%3E%3C/path%3E%3C/svg%3E\");mask-image:url(\"data:image/svg+xml,%3C!-- had to hack this one's viewbox otherwise it didn't line up with the other two --%3E%3C!-- changed viewbox from '0 0 536 512' to '-20 0 576 512' --%3E%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star-half-alt' class='svg-inline--fa fa-star-half-alt fa-w-17' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='-20 0 576 512'%3E%3Cpath fill='currentColor' d='M508.55 171.51L362.18 150.2 296.77 17.81C290.89 5.98 279.42 0 267.95 0c-11.4 0-22.79 5.9-28.69 17.81l-65.43 132.38-146.38 21.29c-26.25 3.8-36.77 36.09-17.74 54.59l105.89 103-25.06 145.48C86.98 495.33 103.57 512 122.15 512c4.93 0 10-1.17 14.87-3.75l130.95-68.68 130.94 68.7c4.86 2.55 9.92 3.71 14.83 3.71 18.6 0 35.22-16.61 31.66-37.4l-25.03-145.49 105.91-102.98c19.04-18.5 8.52-50.8-17.73-54.6zm-121.74 123.2l-18.12 17.62 4.28 24.88 19.52 113.45-102.13-53.59-22.38-11.74.03-317.19 51.03 103.29 11.18 22.63 25.01 3.64 114.23 16.63-82.65 80.38z'%3E%3C/path%3E%3C/svg%3E\")}.star-full{-webkit-mask-image:url(\"data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z'%3E%3C/path%3E%3C/svg%3E\");mask-image:url(\"data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z'%3E%3C/path%3E%3C/svg%3E\")}`],\n})\nexport class NgxStarsComponent implements OnInit, OnDestroy {\n\n  @Input()\n  maxStars: number = 5;\n\n  @Input()\n  initialStars: number = 0;\n\n  @Input()\n  readonly: boolean;\n\n  @Input()\n  size: number;\n\n  @Input()\n  color: string;\n\n  @Input()\n  animation: boolean;\n\n  @Input()\n  animationSpeed: number = 100;\n\n  @Input()\n  customPadding: string;\n\n  @Input()\n  wholeStars: boolean = false;\n\n  @Input()\n  customStarIcons: { empty: string, half: string, full: string };\n\n  @Output()\n  ratingOutput: EventEmitter<number> = new EventEmitter();\n\n  rating: number;\n  editableStars: EditableStar[];\n  animationInterval: any;\n  animationRunning: boolean;\n\n  private customCssClasses: HTMLStyleElement[];\n  private customClassIdentifier = Math.random().toString(36).substring(2);\n\n  ngOnInit(): void {\n    this.setupStarImages();\n    this.editableStars = Array.from(new Array(this.maxStars)).map((elem, index) => new EditableStar(index));\n    this.setRating(this.initialStars);\n\n    if (this.animation) {\n      this.animationInterval = setInterval(this.starAnimation.bind(this), this.animationSpeed);\n    }\n  }\n\n  ngOnDestroy(): void {\n    // remove the three custom classes we created if custom image urls were provided\n    if (this.customCssClasses) {\n      this.customCssClasses.forEach(style => {\n        if (style && style.parentNode) {\n          style.parentNode.removeChild(style);\n        }\n      });\n    }\n  }\n\n  private setupStarImages() {\n    if (this.customStarIcons) {\n      this.customCssClasses = [];\n      Object.keys(this.customStarIcons).map(key => key as StarType).forEach(starType => {\n        const classname = this.getStarClass(starType);\n        this.createCssClass(classname, starType);\n      });\n    }\n  }\n\n  private createCssClass(classname: string, starType: StarType) {\n    const clazz = document.createElement('style');\n    clazz.type = 'text/css';\n    clazz.innerHTML = `.${classname} {\n      -webkit-mask-image: url(${this.customStarIcons[starType]});\n      mask-image: url(${this.customStarIcons[starType]});\n    }`;\n    document.getElementsByTagName('head')[0].appendChild(clazz);\n    this.customCssClasses.push(clazz);\n  }\n\n  starPadding(): { [p: string]: string } {\n    return { 'margin-right': this.customPadding || `0.${this.safeSize()}rem` };\n  }\n\n  starColorAndSize(): { [p: string]: string } {\n    return Object.assign({}, this.starColor(), this.starSize());\n  }\n\n  private starColor(): { [p: string]: string } {\n    return { 'background-color': this.color || 'crimson' };\n  }\n\n  starSize(): { [p: string]: string } {\n    return {\n      height: `${15 * this.safeSize()}px`,\n      width: `${16 * this.safeSize()}px`,\n    };\n  }\n\n  private safeSize = () => (Number.isInteger(this.size) && this.size > 0 && this.size < 6) ? this.size : 1;\n\n  starAnimation(): void {\n    this.animationRunning = true;\n    if (this.rating < this.maxStars) {\n      this.setRating(this.rating += 0.5);\n    }\n    else {\n      this.setRating(0);\n    }\n  }\n\n  cancelStarAnimation(): void {\n    if (this.animationRunning) {\n      clearInterval(this.animationInterval);\n      this.rating = 0;\n      this.animationRunning = false;\n    }\n  }\n\n  setRating(rating: number) {\n    this.rating = Math.round(rating * 2) / 2;\n    this.onStarsUnhover();\n  }\n\n  onStarHover(event: MouseEvent, clickedStar: EditableStar): void {\n    this.cancelStarAnimation();\n\n    const clickedInFirstHalf = this.clickedInFirstHalf(event);\n\n    // fill in either a half or whole star depending on where user clicked\n    clickedStar.classname = (!this.wholeStars && clickedInFirstHalf) ? this.getStarClass('half') : this.getStarClass('full');\n\n    // fill in all stars in previous positions and clear all in later ones\n    this.editableStars.forEach(star => {\n      if (star.position > clickedStar.position) {\n        star.classname = this.getStarClass('empty');\n      }\n      else if (star.position < clickedStar.position) {\n        star.classname = this.getStarClass('full');\n      }\n    });\n  }\n\n  onStarClick(event: MouseEvent, clickedStar: EditableStar): void {\n    this.cancelStarAnimation();\n\n    // lock in current rating\n    const clickedInFirstHalf = this.clickedInFirstHalf(event);\n    this.rating = clickedStar.position + ((!this.wholeStars && clickedInFirstHalf) ? 0.5 : 1);\n    this.ratingOutput.emit(this.rating);\n  }\n\n  // hidden star to left of first star lets user click there to set to 0\n  onZeroStarClick(): void {\n    this.setRating(0);\n    this.ratingOutput.emit(this.rating);\n  }\n\n  onZeroStarHover(): void {\n    // clear all stars\n    this.editableStars.forEach(star => star.classname = this.getStarClass('empty'));\n  }\n\n  onStarsUnhover() {\n    // when user stops hovering we want to make stars reflect the last rating applied by clicking\n    this.editableStars.forEach(star => {\n      const starNumber = star.position + 1;\n      if (this.rating >= starNumber) {\n        star.classname = this.getStarClass('full');\n      }\n      else if (this.rating > starNumber - 1 && this.rating < starNumber) {\n        star.classname = this.getStarClass('half');\n      }\n      else {\n        star.classname = this.getStarClass('empty');\n      }\n    });\n  }\n\n  private clickedInFirstHalf(event: MouseEvent): boolean {\n    const starIcon = event.target as HTMLElement;\n    return event.pageX < starIcon.getBoundingClientRect().left + starIcon.offsetWidth / 2;\n  }\n\n  noop(): void {}\n\n  private getStarClass(starType: StarType) {\n    if (this.customCssClasses) {\n      return `ngx-stars-star-${starType}-${this.customClassIdentifier}`;\n    }\n    return `star-${starType}`;\n  }\n}\n\nexport type StarType = 'empty' | 'half' | 'full';\n\nexport class EditableStar {\n  position: number;\n  classname: string;\n\n  constructor(position: number) {\n    this.position = position;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgxStarsComponent } from './ngx-stars.component';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    NgxStarsComponent\n  ],\n  exports: [\n    NgxStarsComponent\n  ]\n})\nexport class NgxStarsModule { }\n"]}